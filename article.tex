%% 
%% Copyright 2019 Elsevier Ltd
%% 
%% This file is part of the 'CAS Bundle'.
%% --------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'CAS Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for cas-dc documentclass for 
%% double column output.

%\documentclass[a4paper,fleqn,longmktitle]{cas-dc}
\documentclass[a4paper,fleqn]{cas-dc}

%\usepackage[authoryear,longnamesfirst]{natbib}
%\usepackage[authoryear]{natbib}
\usepackage[numbers]{natbib}
%\usepackage{mathpazo}

\input{mymacros.tex}

\begin{document}
\let\WriteBookmarks\relax
\def\floatpagepagefraction{1}
\def\textpagefraction{.001}
\shorttitle{Classification of Parkinson's disease patients using Bayesian deep learning based on fMRI data}
\shortauthors{Amin Amini, Mayam Amirmazlaghani}

\title [mode = title]{Classification of Parkinson's disease patients using Bayesian deep learning based on fMRI data}



\author[1]{Maryam Amirmazlaghani}
\cormark[1]
\ead{mazlaghani@aut.ac.ir}

\author[1]{Amin Amini}
\ead{amin-amini@aut.ac.ir}

\credit{Conceptualization of this study, Methodology, Software}

\address[1]{Department of Computer Engineering and Information Technology, Amirkabir University of Technology, Tehran, Iran}


\cortext[cor1]{Corresponding author}

\begin{abstract}
The goal of resting-state functional magnetic resonance imaging (fMRI) is to investigate the brain's functional connections by using the temporal similarity between blood oxygenation level-dependent (BOLD) signals in different regions of the brain “at rest” as an indicator of synchronous neural activity.
However having different images of patients' brains despite the sequential time-based information, may contain enough data to investigate their brains and enables us to recognize some diseases.
In this paper, we propose a novel method to automatically extract this non-time sequence-based information using a Bayesian deep learning algorithm based on a convolutional neural network (CNN).
Instead of using some predefined points of interest (POIs) we use the whole data in the training phase so those points of the brain which do not contain related information about the disease will be ignored automatically by the trained model.
Moreover, this method does not make any assumptions about the disease, patients, etc.,
makes it a possible universal disease diagnosis approach to differentiate diseases having an impact on brain functionality.
This method is a supervised algorithm with a small number of calculations using three-dimensional CNN.
Each fMRI scan (which contains {\it t} time slices of the brain) of patients will be divided into {\it t} different 3D images enabling us to make the dataset much bigger in number and calculations way simpler.
Subsequently, all of these images are fed to a Bayesian network similar to LeNet-5 (but in three dimensions) to train our model.
Then to determine if a person is suffering from Parkinson's or not, we test his/her {\it t} fMRI images and get {\it t} different results which leads to a fraction (probability) of how unhealthy his/her brain is and if that fraction is above 0.5 we can classify that sample as a Parkinson's patient.
\end{abstract}


%\begin{highlights}
%\item High accuracy with 
%\item Research highlights item 2
%\item Research highlights item 3
%\end{highlights}

\begin{keywords}
Functional magnetic resonance imaging (fMRI) \sep
Resting-state \sep
Disease diagnosis \sep
Bayesian deep learning \sep
Convolutional neural network (CNN) \sep
Parkinson's disease
\end{keywords}


\maketitle

\section{Introduction}

Intro

\section{Materials and methods}


\subsection{Participants}
We had 30 subjects with ACER over 85 and MMSE over 27, comprising 15 healthy controls \texttt{[HC, age 63.33 ± 5.25, 8 females ]}
and 15 patients diagnosed with Parkinson's disease  \texttt{[PD, age 70.73 ± 4.80, 8 females ]}.
Significant differences in age and ACER among two groups were found \texttt{(age: p=0.0012 , ACER: p=0.015)}. However no significant difference in MMSE were found \texttt{(MMSE: p=0.315)}.

\subsection{Data acquisition}
fMRI scans were obtained from the OpenfMRI project which was acquired on a 3T Siemens Verio with repetition time (TR) = 2.5 s, echo time (TE) = 30ms, flip angle = 80°. Each sample contains 198 slices of 39$\times$64$\times$64 voxels from the brains of patients. Subjects were instructed to close their eyes and to rest quietly during the scan session \cite{OpenFmri}.

\subsection{Data pre-processing}
The fMRI data were pre-processed using the standard modules of FMRIB Software Library v5.0 \cite{FMRIB}. The pre-processing steps for the anatomical data involved motion correction (MCFLRIT), skull stripping, and spatial smoothing (Gaussian kernel of 5-mm FWHM). Low level noise was removed using a high-pass temporal filtering. The functional images were then aligned to the individual's high-resolution T1-weighted scans, which were subsequently registered to the Montreal Neurological Institute standard space (MNI152) using affine linear registration. and resampled at 2mm cubic voxels. The product of the preprocessing step was used in the experiments.

\subsection{Three dimensional convolutional neural networks}
3D Convolutional Neural Networks which are inspired by human visual system are similar to classic neural networks. This architecture has been particularly designed based on the explicit assumption that raw data are three-dimensional that enables us to encode certain properties and also to reduce the amount of hyper parameters. The CNN topology utilizes spatial relationships to reduce the number of parameters which must be learned and thus improves upon general feed-forward back propagation training. Equation \eqref{eq:CnnVal} shows how value of each voxel is calculated from previous layer based on a fixed kernel \texttt{(size = P$\times$Q$\times$R)} and a bias for \texttt{j}th feature in \texttt{i}th layers where v is value, f is the activation function and w is filter weight \cite{Ji2013}.

\begin{equation}
v^{ xyz }_{ ij } = \\
f(  \\
b_{ij} +  \\
\sum_m \\ 
\sum_{p=0}^{P_i-1} \\
\sum_{q=0}^{Q_i-1} \\
\sum_{r=0}^{R_i-1} \\
\; w^{pqr}_{ijm}  \\
\; v ^ { (x+p)(y+q)(z+r) }_{ (i-1)m } \\
) \label{eq:CnnVal} 
\end{equation}

Since fMRI images are 3D time series and our experiment tries to find out if images contain any useful information despite their sequences, three dimensional CNN can be used as our computational core. A simple 3D CNN can be seen in Figure \ref{fig:CnnSample}

\begin{figure}
	\includegraphics[width=\linewidth]{images/3dCnn}
	\caption{3D CNN demonstration (kernel size = 3$\times$3$\times$3).}
	\label{fig:CnnSample}
\end{figure}

\subsection{Bayesian deep learning}
Deep learning has achieved significant success in many perception tasks including seeing (visual object recognition), reading (text understanding), and hearing (speech recognition). These are undoubtedly fundamental tasks for a functioning comprehensive artificial intelligence (AI) or data engineering (DE) system. However, in order to build a real AI/DE system, simply being able to see, read, and hear is far from enough. It should master
the ability of thinking.

Take medical diagnosis as an example. Besides seeing
visible symptoms (or medical images from MRI) and hearing descriptions from patients, a doctor has to look for relations among all the symptoms and preferably infer the corresponding etiology. Only after that can the doctor provide medical advice for the patients. In this example, although the abilities of seeing and hearing allow the doctor to acquire information from the patients, it is the thinking part that defines a doctor. Specifically, the ability of thinking here could involve causal inference, logic deduction, and dealing with uncertainty, which is apparently beyond the capability of conventional deep learning methods \cite{Wang2016}.

A neural network with arbitrary depth and non-linearities, with dropout applied before every weight layer, is mathematically equivalent to an approximation to the probabilistic deep Gaussian process \cite{Gal2016}.

\appendix
\section{My Appendix}
Appendix sections are coded under \verb+\appendix+.

\verb+\printcredits+ command is used after appendix sections to list 
author credit taxonomy contribution roles tagged using \verb+\credit+ 
in frontmatter.

\printcredits

%% Loading bibliography style file
%\bibliographystyle{model1-num-names}
\bibliographystyle{cas-model2-names}

% Loading bibliography database
\bibliography{refs}


%\vskip3pt


\end{document}

